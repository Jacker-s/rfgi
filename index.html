<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Midea AC</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#f2f2f7;
  --card:#fff;
  --text:#000;
  --accent:#0a84ff;
}
@media(prefers-color-scheme:dark){
  :root{
    --bg:#000;
    --card:#1c1c1e;
    --text:#fff;
  }
}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display";
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
.phone{
  width:100%;
  max-width:390px;
  padding:20px;
}
.card{
  background:var(--card);
  border-radius:30px;
  padding:24px;
  box-shadow:0 30px 60px rgba(0,0,0,.2);
}
h1{text-align:center;margin-bottom:10px;}
.temp{
  text-align:center;
  font-size:72px;
  font-weight:600;
}
.row{
  display:flex;
  gap:10px;
  margin:14px 0;
}
button{
  flex:1;
  border:none;
  padding:14px;
  border-radius:18px;
  background:rgba(0,0,0,.06);
  font-size:16px;
  transition:.2s;
}
button:active{transform:scale(.95);}
.active{
  background:var(--accent);
  color:white;
}
.status{
  text-align:center;
  font-size:14px;
  opacity:.7;
  margin-top:10px;
}
</style>
</head>

<body>
<div class="phone">
  <div class="card">
    <h1>Ar Condicionado</h1>

    <div class="temp" id="temp">24Â°</div>

    <div class="row">
      <button onclick="setTemp(-1)">âˆ’</button>
      <button onclick="setTemp(1)">+</button>
    </div>

    <div class="row">
      <button class="mode active" onclick="setMode(this,'cool')">â„ï¸ Frio</button>
      <button class="mode" onclick="setMode(this,'fan')">ğŸŒ€ Ventilar</button>
      <button class="mode" onclick="setMode(this,'heat')">ğŸ”¥ Aquecer</button>
    </div>

    <div class="row">
      <button class="fan active" onclick="setFan(this,'low')">ğŸŒ¬ï¸ Baixo</button>
      <button class="fan" onclick="setFan(this,'medium')">ğŸŒ¬ï¸ MÃ©dio</button>
      <button class="fan" onclick="setFan(this,'high')">ğŸŒ¬ï¸ Alto</button>
    </div>

    <div class="row">
      <button onclick="togglePower()">â» Liga/Desliga</button>
      <button onclick="toggleTheme()">ğŸŒ™ Tema</button>
    </div>

    <div class="status" id="status">Ligado â€¢ Frio â€¢ Baixo</div>
  </div>
</div>

<script>
const API="http://localhost:3000/api";
let temp=24,isOn=true,mode="cool",fan="low",dark=false;

async function send(endpoint,data){
  await fetch(`${API}/${endpoint}`,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(data)
  });
}

function setTemp(v){
  if(!isOn) return;
  temp=Math.min(30,Math.max(16,temp+v));
  document.getElementById("temp").innerText=temp+"Â°";
  send("temperature",{value:temp});
}

function setMode(el,m){
  if(!isOn) return;
  document.querySelectorAll(".mode").forEach(b=>b.classList.remove("active"));
  el.classList.add("active");
  mode=m;
  send("mode",{mode});
  update();
}

function setFan(el,f){
  if(!isOn) return;
  document.querySelectorAll(".fan").forEach(b=>b.classList.remove("active"));
  el.classList.add("active");
  fan=f;
  send("fan",{speed:f});
  update();
}

function togglePower(){
  isOn=!isOn;
  send("power",{on:isOn});
  update();
}

function toggleTheme(){
  dark=!dark;
  document.documentElement.style.filter=dark?"invert(1)":"none";
}

function update(){
  document.getElementById("status").innerText=
    isOn?`Ligado â€¢ ${mode} â€¢ ${fan}`:"Desligado";
}

/* PWA */
const manifest={
 name:"Midea AC",
 short_name:"AC",
 start_url:".",
 display:"standalone",
 background_color:"#ffffff",
 theme_color:"#0a84ff"
};
const blob=new Blob([JSON.stringify(manifest)],{type:"application/json"});
const link=document.createElement("link");
link.rel="manifest";
link.href=URL.createObjectURL(blob);
document.head.appendChild(link);

if("serviceWorker"in navigator){
 navigator.serviceWorker.register(
  URL.createObjectURL(new Blob(
   [`self.addEventListener('fetch',()=>{})`],
   {type:"text/javascript"}
  ))
 );
}
</script>
</body>
</html>
